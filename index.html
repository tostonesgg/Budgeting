<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Budget App</title>
  <link rel="stylesheet" href="https://unpkg.com/lucide-static/font/lucide.css">

  <style>
  /* =========================
     Category + Expense Styles
     ========================= */
  .addcat-grid {
    display: grid;
    grid-template-columns: 1fr 1fr auto auto;
    gap: 0.5rem;
    align-items: center;
    margin-bottom: 1rem;
  }

  /* Category header â€“ subtle border only */
  .category-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    margin-bottom: 0.5rem;
    font-weight: 600;
    font-size: 0.95rem;
  }

  .category-header .actions {
    display: flex;
    gap: 0.25rem;
    align-items: center;
  }

  /* Expense row layout */
  .expense-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.25rem 0.5rem;
    border-bottom: 1px solid var(--border);
  }

  .expense-row:last-child {
    border-bottom: none;
  }

  /* Delete button inside expense rows */
  .expense-row button.delete-btn {
    background: none;
    border: none;
    color: var(--text-light);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 4px;
    transition: background 0.2s;
  }

  .expense-row button.delete-btn:hover {
    background: var(--surface-hover);
    color: var(--text);
  }

  /* Hidden color input (triggered by paintbrush button) */
  .color-overlay {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
    pointer-events: none;
  }

  /* =========================
     Theme variables
     ========================= */
  :root {
    --surface: var(--card);
    --surface-hover: #1e293b;
    --border: #475569;
    --text: #f8fafc;
    --text-light: #cbd5e1;
  }

  [data-theme="light"] {
    --surface: #ffffff;
    --surface-hover: #f1f5f9;
    --border: #e2e8f0;
    --text: #0f172a;
    --text-light: #64748b;
  }

  body {
    font-family: system-ui, sans-serif;
    margin: 1rem;
    background: var(--surface);
    color: var(--text);
  }

  h1 {
    font-size: 1.25rem;
    margin-bottom: 1rem;
  }
  </style>
</head>
<body data-theme="dark">
  <h1>Budget App</h1>

  <!-- Add Category -->
  <div class="addcat-grid">
    <input id="newCategoryName" type="text" placeholder="Category name"/>
    <button id="addCategoryBtn">Add Category</button>
  </div>

  <!-- Categories Container -->
  <div id="categories"></div>

  <script>
  // ======== Helpers ========
  function loadCategories() {
    return JSON.parse(localStorage.getItem("categories")) || [];
  }

  function saveCategories(categories) {
    localStorage.setItem("categories", JSON.stringify(categories));
  }

  // ======== Render Category ========
  function renderCategory(cat) {
    const container = document.createElement("div");
    container.className = "category";
    container.dataset.id = cat.id;

    const header = document.createElement("div");
    header.className = "category-header";
    header.style.borderColor = cat.color || "var(--border)";

    const nameSpan = document.createElement("span");
    nameSpan.textContent = cat.name;

    const actions = document.createElement("div");
    actions.className = "actions";

    // Paintbrush button
    const paintBtn = document.createElement("button");
    paintBtn.innerHTML = '<i class="lucide-paintbrush"></i>';
    paintBtn.title = "Change color";

    // Hidden input
    const colorInput = document.createElement("input");
    colorInput.type = "color";
    colorInput.className = "color-overlay";
    colorInput.value = cat.color || "#475569";

    paintBtn.addEventListener("click", () => {
      colorInput.click();
    });

    colorInput.addEventListener("input", (e) => {
      const newColor = e.target.value;
      header.style.borderColor = newColor;

      let cats = loadCategories();
      cats = cats.map(c => c.id === cat.id ? {...c, color: newColor} : c);
      saveCategories(cats);
    });

    actions.appendChild(paintBtn);
    actions.appendChild(colorInput);

    header.appendChild(nameSpan);
    header.appendChild(actions);

    container.appendChild(header);

    return container;
  }

  // ======== Init ========
  function renderAll() {
    const cats = loadCategories();
    const container = document.getElementById("categories");
    container.innerHTML = "";
    cats.forEach(cat => container.appendChild(renderCategory(cat)));
  }

  document.getElementById("addCategoryBtn").addEventListener("click", () => {
    const nameInput = document.getElementById("newCategoryName");
    const name = nameInput.value.trim();
    if (!name) return;

    const cats = loadCategories();
    const newCat = {
      id: Date.now(),
      name,
      color: "#475569"
    };
    cats.push(newCat);
    saveCategories(cats);
    nameInput.value = "";
    renderAll();
  });

  renderAll();
  </script>
</body>
</html>
